masses = {'H':1.00782503207,'H1':1.00782503207,'H2':2.0141017778,'H3':3.0160492777,
            'HE':4.00260325415,'HE4':4.00260325415,'HE3':3.0160293191,
            'LI':7.01600455,'LI7':7.01600455,'LI6':6.015122795,
            'BE':9.0121822,'BE9':9.0121822,
            'B':11.0093054,'B11':11.0093054,'B10':10.0129370,
            'C':12.0000000,'C12':12.0000000,'C13':13.0033548378,'C14':14.003241989,
            'N':14.0030740048,'N14':14.0030740048,'N15':15.0001088982,
            'O':15.99491461956,'O16':15.99491461956,'O18':17.9991610,'O17':16.99913170,
            'F':18.99840322,'F19':18.99840322,
            'NE':19.9924401754,'NE20':19.9924401754,'NE22':21.991385114,'NE21':20.99384668,
            'NA':22.9897692809,'NA23':22.9897692809,
            'MG':23.985041700,'MG24':23.985041700,'MG26':25.982592929,'MG25':24.98583692,
            'AL':26.98153863,'AL27':26.98153863,
            'SI':27.9769265325,'SI28':27.9769265325,'SI29':28.976494700,'SI30':29.97377017,
            'P':30.97376163,'P31':30.97376163,
            'S':31.97207100,'S32':31.97207100,'S34':33.96786690,'S33':32.97145876,'S36':35.96708076,
            'CL':34.96885268,'CL35':34.96885268,'CL37':36.96590259,
            'AR':39.9623831225,'AR40':39.9623831225,'AR36':35.967545106,'AR38':37.9627324,
            'K':38.96370668,'K39':38.96370668,'K41':40.96182576,'K40':39.96399848,
            'CA':39.96259098,'CA40':39.96259098,'CA44':43.9554818,'CA42':41.95861801,'CA48':47.952534,'CA43':42.9587666,'CA46':45.9536926,
            'SC':44.9559119,'SC45':44.9559119,
            'TI':47.9479463,'TI48':47.9479463,'TI46':45.9526316,'TI47':46.9517631,'TI49':48.9478700,'TI50':49.9447912,
            'V':50.9439595,'V51':50.9439595,'V50':49.9471585,
            'CR':51.9405075,'CR52':51.9405075,'CR53':52.9406494,'CR50':49.9460442,'CR54':53.9388804,
            'MN':54.9380451,'MN55':54.9380451,
            'FE':55.9349375,'FE56':55.9349375,'FE54':53.9396105,'FE57':56.9353940,'FE58':57.9332756,
            'CO':58.9331950,'CO59':58.9331950,
            'NI':57.9353429,'NI58':57.9353429,'NI60':59.9307864,'NI62':61.9283451,'NI61':60.9310560,'NI64':63.9279660,
            'CU':62.9295975,'CU63':62.9295975,'CU65':64.9277895,
            'ZN':63.9291422,'ZN64':63.9291422,'ZN66':65.9260334,'ZN68':67.9248442,'ZN67':66.9271273,'ZN70':69.9253193,
            'GA':68.9255736,'GA69':68.9255736,'GA71':70.9247013,
            'GE':73.9211778,'GE74':73.9211778,'GE72':71.9220758,'GE70':69.9242474,'GE76':75.9214026,'GE73':72.9234589,
            'AS':74.9215965,'AS75':74.9215965,
            'SE':79.9165213,'SE80':79.9165213,'SE78':77.9173091,'SE76':75.9192136,'SE82':81.9166994,'SE77':76.9199140,'SE74':73.9224764,
            'BR':78.9183371,'BR79':78.9183371,'BR81':80.9162906,
            'KR':83.911507,'KR84':83.911507,'KR86':85.91061073,'KR82':81.9134836,'KR83':82.914136,'KR80':79.9163790,'KR78':77.9203648,
            'RB':84.911789738,'RB85':84.911789738,'RB87':86.909180527,
            'SR':87.9056121,'SR88':87.9056121,'SR86':85.9092602,'SR87':86.9088771,'SR84':83.913425,
            'Y':88.9058483,'Y89':88.9058483,
            'ZR':89.9047044,'ZR90':89.9047044,'ZR94':93.9063152,'ZR92':91.9050408,'ZR91':90.9056458,'ZR96':95.9082734,
            'NB':92.9063781,'NB93':92.9063781,
            'MO':97.9054082,'MO98':97.9054082,'MO96':95.9046795,'MO95':94.9058421,'MO92':91.906811,'MO100':99.907477,'MO97':96.9060215,'MO94':93.9050883,
            'TC':98.9062547,'TC99':98.9062547,'TC98':97.907216,'TC97':96.906365,
            'RU':101.9043493,'RU102':101.9043493,'RU104':103.905433,'RU101':100.9055821,'RU99':98.9059393,'RU100':99.9042195,'RU96':95.907598,'RU98':97.905287,
            'RH':102.905504,'RH103':102.905504,
            'PD':105.903486,'PD106':105.903486,'PD108':107.903892,'PD105':104.905085,'PD110':109.905153,'PD104':103.904036,'PD102':101.905609,
            'AG':106.905097,'AG107':106.905097,'AG109':108.904752,
            'CD':113.9033585,'CD114':113.9033585,'CD112':111.9027578,'CD111':110.9041781,'CD110':109.9030021,'CD113':112.9044017,'CD116':115.904756,'CD106':105.906459,'CD108':107.904184,
            'IN':114.903878,'IN115':114.903878,'IN113':112.904058,
            'SN':119.9021947,'SN120':119.9021947,'SN118':117.901603,'SN116':115.901741,'SN119':118.903308,'SN117':116.902952,'SN124':123.9052739,'SN122':121.9034390,'SN112':111.904818,'SN114':113.902779,'SN115':114.903342,
            'SB':120.9038157,'SB121':120.9038157,'SB123':122.9042140,
            'TE':129.9062244,'TE130':129.9062244,'TE128':127.9044631,'TE126':125.9033117,'TE125':124.9044307,'TE124':123.9028179,'TE122':121.9030439,'TE123':122.9042700,'TE120':119.904020,
            'I':126.904473,'I127':126.904473,
            'XE':131.9041535,'XE132':131.9041535,'XE129':128.9047794,'XE131':130.9050824,'XE134':133.9053945,'XE136':135.907219,'XE130':129.9035080,'XE128':127.9035313,'XE124':123.9058930,'XE126':125.904274,
            'CS':132.905451933,'CS133':132.905451933,
            'BA':137.9052472,'BA138':137.9052472,'BA137':136.9058274,'BA136':135.9045759,'BA135':134.9056886,'BA134':133.9045084,'BA130':129.9063208,'BA132':131.9050613,
            'LA':138.9063533,'LA139':138.9063533,'LA138':137.907112,
            'CE':139.9054387,'CE140':139.9054387,'CE142':141.909244,'CE138':137.905991,'CE136':135.907172,
            'PR':140.9076528,'PR141':140.9076528,
            'ND':141.9077233,'ND142':141.9077233,'ND144':143.9100873,'ND146':145.9131169,'ND143':142.9098143,'ND145':144.9125736,'ND148':147.916893,'ND150':149.920891,
            'PM':146.9151385,'PM147':146.9151385,'PM145':144.912749,
            'SM':151.9197324,'SM152':151.9197324,'SM154':153.9222093,'SM147':146.9148979,'SM149':148.9171847,'SM148':147.9148227,'SM150':149.9172755,'SM144':143.911999,
            'EU':152.9212303,'EU153':152.9212303,'EU151':150.9198502,
            'GD':157.9241039,'GD158':157.9241039,'GD160':159.9270541,'GD156':155.9221227,'GD157':156.9239601,'GD155':154.9226220,'GD154':153.9208656,'GD152':151.9197910,
            'TB':158.9253468,'TB159':158.9253468,
            'DY':163.9291748,'DY164':163.9291748,'DY162':161.9267984,'DY163':162.9287312,'DY161':160.9269334,'DY160':159.9251975,'DY158':157.924409,'DY156':155.924283,
            'HO':164.9303221,'HO165':164.9303221,
            'ER':165.9302931,'ER166':165.9302931,'ER168':167.9323702,'ER167':166.9320482,'ER170':169.9354643,'ER164':163.929200,'ER162':161.928778,
            'TM':168.9342133,'TM169':168.9342133,
            'YB':173.9388621,'YB174':173.9388621,'YB172':171.9363815,'YB173':172.9382108,'YB171':170.9363258,'YB176':175.9425717,'YB170':169.9347618,'YB168':167.933897,
            'LU':174.9407718,'LU175':174.9407718,'LU176':175.9426863,
            'HF':179.9465500,'HF180':179.9465500,'HF178':177.9436988,'HF177':176.9432207,'HF179':178.9458161,'HF176':175.9414086,'HF174':173.940046,
            'TA':180.9479958,'TA181':180.9479958,'TA180':179.9474648,
            'W':183.9509312,'W184':183.9509312,'W186':185.9543641,'W182':181.9482042,'W183':182.9502230,'W180':179.946704,
            'RE':186.9557531,'RE187':186.9557531,'RE185':184.9529550,
            'OS':191.9614807,'OS192':191.9614807,'OS190':189.9584470,'OS189':188.9581475,'OS188':187.9558382,'OS187':186.9557505,'OS186':185.9538382,'OS184':183.9524891,
            'IR':192.9629264,'IR193':192.9629264,'IR191':190.9605940,
            'PT':194.9647911,'PT195':194.9647911,'PT194':193.9626803,'PT196':195.9649515,'PT198':197.967893,'PT192':191.9610380,'PT190':189.959932,
            'AU':196.9665687,'AU197':196.9665687,
            'HG':201.9706430,'HG202':201.9706430,'HG200':199.9683260,'HG199':198.9682799,'HG201':200.9703023,'HG198':197.9667690,'HG204':203.9734939,'HG196':195.965833,
            'TL':204.9744275,'TL205':204.9744275,'TL203':202.9723442,
            'PB':207.9766521,'PB208':207.9766521,'PB206':205.9744653,'PB207':206.9758969,'PB204':203.9730436,
            'BI':208.9803987,'BI209':208.9803987,
            'PO':209.9828737,'PO210':209.9828737,'PO209':208.9824304,
            'AT':210.9874963,'AT211':210.9874963,'AT210':209.987148,
            'RN':222.0175777,'RN222':222.0175777,'RN220':220.0113940,'RN211':210.990601,
            'FR':223.0197359,'FR223':223.0197359,
            'RA':228.0310703,'RA228':228.0310703,'RA226':226.0254098,'RA224':224.0202118,'RA223':223.0185022,
            'AC':227.0277521,'AC227':227.0277521,
            'TH':232.0380553,'TH232':232.0380553,'TH230':230.0331338,
            'PA':231.0358840,'PA231':231.0358840,
            'U':238.0507882,'U238':238.0507882,'U235':235.0439299,'U234':234.0409521,'U236':236.0455680,'U233':233.0396352,
            'NP':237.0481734,'NP237':237.0481734,'NP236':236.046570,
            'PU':244.064204,'PU244':244.064204,'PU242':242.0587426,'PU241':241.0568515,'PU240':240.0538135,'PU239':239.0521634,'PU238':238.0495599,
            'AM':243.0613811,'AM243':243.0613811,'AM241':241.0568291,
            'CM':248.072349,'CM248':248.072349,'CM247':247.070354,'CM246':246.0672237,'CM245':245.0654912,'CM244':244.0627526,'CM243':243.0613891,
            'BK':249.0749867,'BK249':249.0749867,'BK247':247.070307,
            'CF':252.081626,'CF252':252.081626,'CF251':251.079587,'CF250':250.0764061,'CF249':249.0748535,
            'ES':252.082980,'ES252':252.082980,
            'FM':257.095105,'FM257':257.095105}
for key in masses:
   masses[key] *= 1822.88848477

max_valence = {'H':1,'HE':0,'LI':1,'BE':2,'B':3,'C':4,'N':3,'O':2,'F':1,'NE':0,
               'NA':1,'MG':2,'AL':6,'SI':4,'P':3,'S':2,'CL':1,'AR':0,'K':1,'CA':2,
               'SC':6,'TI':6,'V':6,'CR':6,'MN':6, 'FE':6,'CO':6,'NI':6,'CU':6,'ZN':6,
               'GA':6,'GE':6,'AS':3,'SE':2,'BR':1,'KR':0 }
# 'Q':4, 'CE':4, 'LA':6